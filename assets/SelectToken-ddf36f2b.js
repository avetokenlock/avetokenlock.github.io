import{T as I,g as G,f as V,a as T,B as L}from"./TokenIcon-5a9381f3.js";import{_ as J,b as K,B as P,W as Q,d as X,E as Y,r as f,f as Z,H as ee,g as b,o as r,h,c as m,j as s,n as x,t as c,F as g,q as D,k as n,w as $,I as te,x as p,L as E,A as O,D as oe,z as se}from"./index-9e5309be.js";import{l as ne}from"./lpABI-5e9b72a1.js";const ae={class:"body"},le={class:"content"},ce={class:"type"},ie={class:"network"},re={class:"network-list"},de=["onClick"],ue={class:"item-left"},ke={class:"left-content"},ve={class:"token-name"},he={class:"token-address"},_e={class:"token"},fe={class:"left-content"},me={class:"token-name"},pe={class:"token-address"},Ce={class:"item-right"},we={class:"item-right-left"},ye={class:"qty"},Le={class:"amount"},be={class:"item-right-right"},ge={__name:"SelectToken",setup(Ie){const R=K("global"),S=P();Q();const v=X(),{t:M}=Y(),C=f([]),d=f([]),l=f(""),u=f(0),U=Z(()=>u.value==0?l.value?l.value.startsWith("0x")?C.value.filter(t=>t.address.toLowerCase()==l.value.toLowerCase()):C.value.filter(t=>t.symbol.toLowerCase().indexOf(l.value.toLowerCase())>-1):C.value:u.value==1?l.value?l.value.startsWith("0x")?d.value.filter(t=>t.address.toLowerCase()==l.value.toLowerCase()):d.value.filter(t=>t.symbol.toLowerCase().indexOf(l.value.toLowerCase())>-1):d.value:[]),B=R.cfg.allowChainList,i=f(B[0]);async function W(t){i.value.chain!=t.chain&&(i.value=t,A())}async function A(){const t=se({message:"Loading...",forbidClick:!0,duration:0}),a=await p.debank.getTokenList(v.walletAddress,i.value.chain);let k=[],_=[];for(let e of a.data.data)e.token=="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"&&(e.token=p.wallet.MAIN_COIN_ADDRESS),new RegExp("^0x.*$","gi").test(e.token)&&e.value>0&&e.risk_score<60&&e.risk_level>=0&&e.flag!=="blacklist"&&e.symbol!==""&&(e.flag=="lp"?_.push({tokenList:[{address:"",symbol:""},{address:"",symbol:""}],symbol:"",address:e.token.toLowerCase(),tokenId:`${e.token}-${e.chain}`.toLowerCase(),chain:e.chain.toLowerCase(),decimals:e.decimals,amount:e.value,price:e.current_price_usd,hasTokenInfo:!1,tokenType:1,chainCoinSymbol:i.value.chainCoinSymbol,name:e.name}):k.push({address:e.token.toLowerCase(),tokenId:`${e.token}-${e.chain}`.toLowerCase(),chain:e.chain.toLowerCase(),symbol:e.symbol,decimals:e.decimals,icon:T(e.chain.toLowerCase(),e.token.toLowerCase()),amount:e.value,price:e.current_price_usd,tokenType:0,chainCoinSymbol:i.value.chainCoinSymbol,name:e.name}));C.value=k,d.value=_,t.close()}const N="/create";function j(t){v.token=t,S.push(N)}function q(){S.push(N)}async function z(){console.log("init"),v.isConnectWallet&&await A()}function F(t){u.value!=t&&(u.value=t,t===1&&H())}async function H(){if(d.value.length!=0){if(i.value.chainId!=v.chainId){te(M("switchTrueChain",{cahin:i.value.chain})),d.value=[];return}for(let t of d.value)if(t.hasTokenInfo==!1){let a=p.wallet.contract(t.address,ne),k=await a.token0(),e=await p.wallet.contract(k,E).symbol(),w=await a.token1(),y=await p.wallet.contract(w,E).symbol();t.tokenList[0]={symbol:e.toUpperCase(),address:k.toLowerCase()},t.tokenList[1]={symbol:y.toUpperCase(),address:w.toLowerCase()},t.symbol=`${e}/${y}`}}}return ee(()=>{console.log("onMounted"),z()}),(t,a)=>{const k=b("van-search"),_=b("van-icon"),e=b("van-cell"),w=b("van-list");return r(),h("div",ae,[m(k,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=o=>l.value=o),shape:"round","show-action":"",placeholder:t.$t("searchTokenContractOrName"),"action-text":t.$t("cancel"),onCancel:q},null,8,["modelValue","placeholder","action-text"]),s("div",le,[s("div",ce,[s("div",{class:x({select:u.value==0}),onClick:a[1]||(a[1]=o=>F(0))},c(t.$t("myToken")),3),s("div",{class:x({select:u.value==1}),onClick:a[2]||(a[2]=o=>F(1))},c(t.$t("myLp")),3)]),s("div",ie,[s("ul",re,[(r(!0),h(g,null,D(n(B),o=>(r(),h("li",{class:x(i.value.chain==o.chain?"network-selected":""),onClick:y=>W(o)},c(o.chain.toUpperCase()),11,de))),256))])]),s("div",null,[m(w,{"finished-text":t.$t("noMore"),class:"token-list"},{default:$(()=>[(r(!0),h(g,null,D(n(U),o=>(r(),O(e,{class:"item",key:o,onClick:y=>j(o)},{title:$(()=>[s("div",ue,[u.value==0?(r(),h(g,{key:0},[m(I,{class:"token-icon-1",tokenIcon:o.icon,chainIcon:n(G)(o.chain)},null,8,["tokenIcon","chainIcon"]),s("div",ke,[s("div",ve,c(o.symbol),1),s("div",he,c(n(V)(o.address)),1)])],64)):(r(),h(g,{key:1},[s("div",_e,[m(I,{class:"token-icon-2",tokenIcon:n(T)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),m(I,{class:"token-icon-2",tokenIcon:n(T)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"])]),s("div",fe,[s("div",me,c(o.symbol),1),s("div",pe,c(n(V)(o.address)),1)])],64))])]),value:$(()=>[s("div",Ce,[s("div",we,[s("div",ye,c(n(L)(o.amount).toString().indexOf(".")==-1?n(L)(o.amount):n(L)(o.amount).toFixed(6)),1),s("div",Le,"$"+c(n(L)(o.amount).multipliedBy(o.price).toFixed(2)),1)]),s("div",be,[n(v).token&&n(v).token.address==o.address?(r(),O(_,{key:0,name:"success",color:"#3F80F7"})):oe("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},Se=J(ge,[["__scopeId","data-v-bb2df05c"]]);export{Se as default};
