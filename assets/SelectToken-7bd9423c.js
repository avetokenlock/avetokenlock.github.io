import{T as x}from"./TokenIcon-70b61560.js";import{_ as P,b as G,y as Q,U as X,x as Y,B as Z,r as f,C as V,w as ee,E as te,d as y,o as r,f as b,c as p,h as o,H as B,F as L,z as M,v as n,g as I,t as k,q as O,K as se,l as oe,k as _,I as R}from"./index-16fefa86.js";import{a as ae,f as U,b as T,B as g}from"./bignumber-0890a5b7.js";import{l as ne}from"./lpABI-5e9b72a1.js";const le={class:"content"},ce={class:"type"},ie={class:"network"},re={class:"network-list"},de=["onClick"],ue={class:"item-left"},ke={class:"left-content"},ve={class:"token-name"},fe={class:"token-address"},be={class:"token"},_e={class:"left-content"},he={class:"token-name"},me={class:"token-address"},pe={class:"item-right"},we={class:"item-right-left"},Ce={class:"qty"},ye={class:"amount"},Le={class:"item-right-right"},ge={__name:"SelectToken",setup(xe){const z=G("global"),A=Q();X();const d=Y();Z();const D=f([]),h=f([]),m=f([]),c=f(""),u=f(0),W=V(()=>u.value==0?c.value?c.value.startsWith("0x")?h.value.filter(t=>t.address.toLowerCase()==c.value.toLowerCase()):h.value.filter(t=>t.symbol.toLowerCase().indexOf(c.value.toLowerCase())>-1):h.value:u.value==1?c.value?c.value.startsWith("0x")?m.value.filter(t=>t.address.toLowerCase()==c.value.toLowerCase()):m.value.filter(t=>t.symbol.toLowerCase().indexOf(c.value.toLowerCase())>-1):m.value:[]),w={text:"BSC",value:"bsc",isAllow:!0},v=f({text:w.text,value:w.value,isAllow:w.isAllow}),q=V(()=>{let t=[w];for(let a of D.value){let l=z.cfg.allowChainList.some(e=>e.chain==a.chain),i={text:a.chain.toUpperCase(),value:a.chain,isAllow:l};t.push(i)}return t});async function j(t){t.isAllow&&v.value.value!=t.value&&(v.value=t,F())}async function F(){if(v.value.value=="tbsc"){h.value=[{address:"0x0000000000000000000000000000000000000000",tokenId:"0x0000000000000000000000000000000000000000-bsc",chain:"bsc",symbol:"BNB",decimals:18,icon:"https://ave.s3.ap-east-1.amazonaws.com/token_icon/bsc/0x0000000000000000000000000000000000000000.png",amount:.19955571,price:290.2},{address:"0x227A05695F10B591731Fd925396b548a45067798",tokenId:"0x227A05695F10B591731Fd925396b548a45067798-bsc",chain:"bsc",symbol:"JF",decimals:18,icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:99999,price:1},{address:"0xfBFB9B43aE76322a804b69A5f36671312541dd0F",tokenId:"0xfBFB9B43aE76322a804b69A5f36671312541dd0F-bsc",chain:"bsc",symbol:"BT",decimals:18,icon:"https://static.debank.com/image/bsc_token/logo_url/0x5fac926bf1e638944bb16fb5b787b5ba4bc85b0a/74d0d0f5a5fcf76ab35b89b29cb9c95e.png",amount:99999,price:1}];return}let t=[];const a=oe({message:"Loading...",forbidClick:!0,duration:0});v.value.value=="all"?t=await _.debank.getAllTokenList(d.walletAddress):t=await _.debank.getTokenList(d.walletAddress,v.value.value);let l=[],i=[];for(let e of t.data.data)e.token=="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"&&(e.token=_.wallet.MAIN_COIN_ADDRESS),new RegExp("^0x.*$","gi").test(e.token)&&e.value>0&&e.risk_score<60&&e.risk_level>=0&&e.flag!=="blacklist"&&e.symbol!==""&&(e.flag=="lp"?i.push({tokenList:[{address:"",symbol:""},{address:"",symbol:""}],symbol:"",address:e.token.toLowerCase(),tokenId:`${e.token}-${e.chain}`.toLowerCase(),chain:e.chain.toLowerCase(),decimals:e.decimals,amount:e.value,price:e.current_price_usd,hasTokenInfo:!1,tokenType:1,chainMainCoinSymbol:"BNB",name:e.name}):l.push({address:e.token.toLowerCase(),tokenId:`${e.token}-${e.chain}`.toLowerCase(),chain:e.chain.toLowerCase(),symbol:e.symbol,decimals:e.decimals,icon:T(e.chain.toLowerCase(),e.token.toLowerCase()),amount:e.value,price:e.current_price_usd,tokenType:0,chainMainCoinSymbol:"BNB",name:e.name}));h.value=l,m.value=i,a.close()}const S="/create";function H(t){d.isSelectSearchToken=!1,d.token=t,A.push(S)}function J(){A.push(S)}async function K(){d.isConnectWallet&&await F()}function $(t){u.value!=t&&(u.value=t)}return ee(m,async(t,a)=>{console.log("lpList changed");for(let l of t)if(l.hasTokenInfo==!1){let i=_.wallet.contract(l.address,ne),e=await i.token0(),s=await _.wallet.contract(e,R).symbol(),C=await i.token1(),E=await _.wallet.contract(C,R).symbol();l.tokenList[0]={symbol:s.toUpperCase(),address:e.toLowerCase()},l.tokenList[1]={symbol:E.toUpperCase(),address:C.toLowerCase()},l.symbol=`${s}/${E}`}}),te(()=>{console.log("onMounted"),K()}),(t,a)=>{const l=y("van-search"),i=y("van-icon"),e=y("van-cell"),N=y("van-list");return r(),b("div",null,[p(l,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=s=>c.value=s),shape:"round","show-action":"",placeholder:t.$t("searchTokenContractOrName"),"action-text":t.$t("cancel"),onCancel:J},null,8,["modelValue","placeholder","action-text"]),o("div",le,[o("div",ce,[o("div",{class:B({select:u.value==0}),onClick:a[1]||(a[1]=s=>$(0))},"我的代币",2),o("div",{class:B({select:u.value==1}),onClick:a[2]||(a[2]=s=>$(1))},"我的LP",2)]),o("div",ie,[o("ul",re,[(r(!0),b(L,null,M(n(q),s=>(r(),b("li",{class:B(v.value.value==s.value?"network-selected":""),onClick:C=>j(s)},k(s.text),11,de))),256))])]),o("div",null,[p(N,{"finished-text":t.$t("noMore"),class:"token-list"},{default:I(()=>[(r(!0),b(L,null,M(n(W),s=>(r(),O(e,{class:"item",key:s,onClick:C=>H(s)},{title:I(()=>[o("div",ue,[u.value==0?(r(),b(L,{key:0},[p(x,{class:"token-icon-1",tokenIcon:s.icon,chainIcon:n(ae)(s.chain)},null,8,["tokenIcon","chainIcon"]),o("div",ke,[o("div",ve,k(s.symbol),1),o("div",fe,k(n(U)(s.address)),1)])],64)):(r(),b(L,{key:1},[o("div",be,[p(x,{class:"token-icon-2",tokenIcon:n(T)(s.chain,s.tokenList[0].address)},null,8,["tokenIcon"]),p(x,{class:"token-icon-2",tokenIcon:n(T)(s.chain,s.tokenList[1].address)},null,8,["tokenIcon"])]),o("div",_e,[o("div",he,k(s.symbol),1),o("div",me,k(n(U)(s.address)),1)])],64))])]),value:I(()=>[o("div",pe,[o("div",we,[o("div",Ce,k(n(g)(s.amount).toString().indexOf(".")==-1?n(g)(s.amount):n(g)(s.amount).toFixed(6)),1),o("div",ye,"$"+k(n(g)(s.amount).multipliedBy(s.price).toFixed(2)),1)]),o("div",Le,[n(d).token&&n(d).token.address==s.address?(r(),O(i,{key:0,name:"success",color:"#3F80F7"})):se("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},Se=P(ge,[["__scopeId","data-v-ea655484"]]);export{Se as default};
