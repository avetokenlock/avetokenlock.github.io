import{T as $,g as P,f as V,a as S}from"./TokenIcon-343e5e37.js";import{_ as X,b as G,B as J,X as K,d as Q,E as Y,r as m,f as Z,H as ee,g as b,o as d,h as v,c as p,j as s,n as B,t as r,F as g,q as D,k as n,w as A,I as te,x as _,L as E,A as O,D as oe,z as se}from"./index-43efc6f2.js";import{B as I}from"./bignumber-3e8dfdf6.js";import{l as ne}from"./lpABI-5e9b72a1.js";const ae={class:"body"},le={class:"content"},ce={class:"type"},ie={class:"network"},re={class:"network-list"},de=["onClick"],ue={class:"item-left"},ke={class:"left-content"},he={class:"token-name"},ve={class:"token-address"},_e={class:"token"},fe={class:"left-content"},me={class:"token-name"},pe={class:"token-address"},Ce={class:"item-right"},we={class:"item-right-left"},ye={class:"qty"},Le={class:"amount"},be={class:"item-right-right"},ge={__name:"SelectToken",setup(Ie){const R=G("global"),T=J();K();const c=Q(),{t:M}=Y(),C=m([]),u=m([]),l=m(""),k=m(0),U=Z(()=>k.value==0?l.value?l.value.startsWith("0x")?C.value.filter(e=>e.address.toLowerCase()==l.value.toLowerCase()):C.value.filter(e=>e.symbol.toLowerCase().indexOf(l.value.toLowerCase())>-1):C.value:k.value==1?l.value?l.value.startsWith("0x")?u.value.filter(e=>e.address.toLowerCase()==l.value.toLowerCase()):u.value.filter(e=>e.symbol.toLowerCase().indexOf(l.value.toLowerCase())>-1):u.value:[]),w=R.cfg.allowChainList,i=m(w.find(e=>e.chainId==c.chainId)?w.find(e=>e.chainId==c.chainId):w[0]);async function W(e){i.value.chain!=e.chain&&(i.value=e,N(),_.wallet.switchNetwork(i.value.chainId))}async function N(){const e=se({message:"Loading...",forbidClick:!0,duration:0}),a=await _.debank.getTokenList(c.walletAddress,i.value.chain);let h=[],f=[];for(let t of a.data.data){if(t.token=="0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee"){t.token=_.wallet.MAIN_COIN_ADDRESS;continue}if(new RegExp("^0x.*$","gi").test(t.token)&&t.value>0&&t.risk_score<60&&t.risk_level>=0&&t.flag!=="blacklist"&&t.symbol!==""){if(t.token=="0xc748673057861a797275cd8a068abb95a902e8de")continue;t.flag=="lp"?f.push({tokenList:[{address:"",symbol:""},{address:"",symbol:""}],symbol:"",address:t.token.toLowerCase(),tokenId:`${t.token}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),decimals:t.decimals,amount:t.value,price:t.current_price_usd,hasTokenInfo:!1,tokenType:1,chainCoinSymbol:i.value.chainCoinSymbol,name:t.name}):h.push({address:t.token.toLowerCase(),tokenId:`${t.token}-${t.chain}`.toLowerCase(),chain:t.chain.toLowerCase(),symbol:t.symbol,decimals:t.decimals,icon:S(t.chain.toLowerCase(),t.token.toLowerCase()),amount:t.value,price:t.current_price_usd,tokenType:0,chainCoinSymbol:i.value.chainCoinSymbol,name:t.name})}}C.value=h,u.value=f,e.close()}const x="/create";function j(e){c.token=e,c.prevPath.toLowerCase()==x?T.back():T.push(x)}function q(){T.push(x)}async function z(){console.log("init"),c.isConnectWallet&&await N()}function F(e){k.value!=e&&(k.value=e,e===1&&H())}async function H(){if(u.value.length!=0){if(i.value.chainId!=c.chainId){te(M("switchTrueChain",{cahin:i.value.chain})),u.value=[];return}for(let e of u.value)if(e.hasTokenInfo==!1){let a=_.wallet.contract(e.address,ne),h=await a.token0(),t=await _.wallet.contract(h,E).symbol(),y=await a.token1(),L=await _.wallet.contract(y,E).symbol();e.tokenList[0]={symbol:t.toUpperCase(),address:h.toLowerCase()},e.tokenList[1]={symbol:L.toUpperCase(),address:y.toLowerCase()},e.symbol=`${t}/${L}`}}}return ee(()=>{console.log("onMounted"),z()}),(e,a)=>{const h=b("van-search"),f=b("van-icon"),t=b("van-cell"),y=b("van-list");return d(),v("div",ae,[p(h,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=o=>l.value=o),shape:"round","show-action":"",placeholder:e.$t("searchTokenContractOrName"),"action-text":e.$t("cancel"),onCancel:q},null,8,["modelValue","placeholder","action-text"]),s("div",le,[s("div",ce,[s("div",{class:B({select:k.value==0}),onClick:a[1]||(a[1]=o=>F(0))},r(e.$t("myToken")),3),s("div",{class:B({select:k.value==1}),onClick:a[2]||(a[2]=o=>F(1))},r(e.$t("myLp")),3)]),s("div",ie,[s("ul",re,[(d(!0),v(g,null,D(n(w),o=>(d(),v("li",{class:B(i.value.chain==o.chain?"network-selected":""),onClick:L=>W(o)},r(o.chain.toUpperCase()),11,de))),256))])]),s("div",null,[p(y,{"finished-text":e.$t("noMore"),class:"token-list"},{default:A(()=>[(d(!0),v(g,null,D(n(U),o=>(d(),O(t,{class:"item",key:o,onClick:L=>j(o)},{title:A(()=>[s("div",ue,[k.value==0?(d(),v(g,{key:0},[p($,{class:"token-icon-1",tokenIcon:o.icon,chainIcon:n(P)(o.chain)},null,8,["tokenIcon","chainIcon"]),s("div",ke,[s("div",he,r(o.symbol),1),s("div",ve,r(n(V)(o.address)),1)])],64)):(d(),v(g,{key:1},[s("div",_e,[p($,{class:"token-icon-2",tokenIcon:n(S)(o.chain,o.tokenList[0].address)},null,8,["tokenIcon"]),p($,{class:"token-icon-2",tokenIcon:n(S)(o.chain,o.tokenList[1].address)},null,8,["tokenIcon"])]),s("div",fe,[s("div",me,r(o.symbol),1),s("div",pe,r(n(V)(o.address)),1)])],64))])]),value:A(()=>[s("div",Ce,[s("div",we,[s("div",ye,r(n(I)(o.amount).toString().indexOf(".")==-1?n(I)(o.amount):n(I)(o.amount).toFixed(6,1)),1),s("div",Le,"$"+r(n(I)(o.amount).multipliedBy(o.price).toFixed(2,1)),1)]),s("div",be,[n(c).token&&n(c).token.address==o.address?(d(),O(f,{key:0,name:"success",color:"#3F80F7"})):oe("",!0)])])]),_:2},1032,["onClick"]))),128))]),_:1},8,["finished-text"])])])])}}},Be=X(ge,[["__scopeId","data-v-e68367ed"]]);export{Be as default};
